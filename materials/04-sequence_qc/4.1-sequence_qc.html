<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.112">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4.1 Sequencing Quality Control</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../materials/05-short_read_mapping/5.1-short_read_mapping.html" rel="next">
<link href="../../materials/03-file_formats/3.1-file_formats.html" rel="prev">
<link href="../../site_libs/quarto-contrib/quarto-project/cambiotraining/courseformat/img/university-of-cambridge-favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../site_libs/quarto-contrib/quarto-project/cambiotraining/courseformat/img/NMIMR_Logo_whitebg.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../setup.html">Setup</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../materials.html" aria-current="page">Materials</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../unix_cheat_sheet.html">Unix-Cheat-Sheet</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/avantonder/Ghana_course"><i class="bi bi-github" role="img" aria-label="Introduction to bacterial genomics GitHub">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/NMIMR_UG"><i class="bi bi-twitter" role="img" aria-label="Noguchi Memorial Institute for Medical Research Twitter">
</i> 
 </a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">4.1 Sequencing Quality Control</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials.html" class="sidebar-item-text sidebar-link">Materials</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">1. Introduction to WGS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/01-intro_wgs/1.1-intro_wgs.html" class="sidebar-item-text sidebar-link">1.1 Introduction to Whole Genome Sequencing (WGS)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">2. Introduction to Unix</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/02-unix_intro/2.1-unix_overview.html" class="sidebar-item-text sidebar-link">2.1 The Unix Shell</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/02-unix_intro/2.2-files_directories.html" class="sidebar-item-text sidebar-link">2.2 Navigating Files and Directories</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/02-unix_intro/2.3-text_manipulation.html" class="sidebar-item-text sidebar-link">2.3 Text Manipulation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/02-unix_intro/2.4-combining_commands.html" class="sidebar-item-text sidebar-link">2.4 Combining Commands</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/02-unix_intro/2.5-using_remote_resources.html" class="sidebar-item-text sidebar-link">2.5 Using remote resources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/02-unix_intro/2.6-vscode_overview.html" class="sidebar-item-text sidebar-link">2.6 Visual Studio Code</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/02-unix_intro/2.7-bonus_find_and_grep.html" class="sidebar-item-text sidebar-link">2.7 <em>Bonus</em> : Finding Things</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/02-unix_intro/2.8-bonus_loops.html" class="sidebar-item-text sidebar-link">2.8 <em>Bonus</em>: Loops</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/02-unix_intro/2.9-bonus_shell_scripts.html" class="sidebar-item-text sidebar-link">2.9 <em>Bonus</em>: Shell Scripts</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">3. Common File Formats</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/03-file_formats/3.1-file_formats.html" class="sidebar-item-text sidebar-link">3.1 Common File Formats</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">4. Sequencing QC</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/04-sequence_qc/4.1-sequence_qc.html" class="sidebar-item-text sidebar-link active">4.1 Sequencing Quality Control</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">5. Short Read Mapping</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/05-short_read_mapping/5.1-short_read_mapping.html" class="sidebar-item-text sidebar-link">5.1 Short Read Mapping</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">6. Assembly and Annotation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/06-assembly_annotation/6.1-assembly_annotation.html" class="sidebar-item-text sidebar-link">6.1 Assembly and Annotation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">7. Software Management</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/07-software_management/7.1-software_management.html" class="sidebar-item-text sidebar-link">7.1 Managing Software</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">8. Workflow Managers</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/08-workflow_managers/8.1-workflow_managers.html" class="sidebar-item-text sidebar-link">8.1 Workflow Managers</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/08-workflow_managers/8.2-nfcore.html" class="sidebar-item-text sidebar-link">8.2 nf-core pipelines</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">9. The nf-core/bactmap Pipeline</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/09-bactmap/9.1-bactmap_run.html" class="sidebar-item-text sidebar-link">9.1 The nf-core/bactmap pipeline</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/09-bactmap/9.2-bactmap_results.html" class="sidebar-item-text sidebar-link">9.2 nf-core/bactmap Results</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">10. Introduction to Phylogenetics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/10-intro_phylogenetics/10.1-intro_phylogenetics.html" class="sidebar-item-text sidebar-link">10.1 Introduction to Phylogenetics</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">11. Bacterial Genotyping and AMR prediction</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/11-genotyping/11.1-genotyping.html" class="sidebar-item-text sidebar-link">11.1 Bacterial Genotyping and Drug Resistance Prediction</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">12. Introduction to HPC</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../materials/12-intro_hpc/12.1-intro_hpc.html" class="sidebar-item-text sidebar-link">12.1 Introduction to High Performance Computing</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">4.1.1 Background</a>
  <ul class="collapse">
  <li><a href="#qc-assessment-of-ngs-data" id="toc-qc-assessment-of-ngs-data" class="nav-link" data-scroll-target="#qc-assessment-of-ngs-data">QC assessment of NGS data</a></li>
  </ul></li>
  <li><a href="#change-to-the-qc-directory-and-activate-the-qc-environment" id="toc-change-to-the-qc-directory-and-activate-the-qc-environment" class="nav-link" data-scroll-target="#change-to-the-qc-directory-and-activate-the-qc-environment">4.1.2 Change to the <code>QC</code> directory and activate the <code>qc</code> environment</a></li>
  <li><a href="#generating-qc-stats-and-metrics" id="toc-generating-qc-stats-and-metrics" class="nav-link" data-scroll-target="#generating-qc-stats-and-metrics">4.1.3 Generating QC stats and metrics</a>
  <ul class="collapse">
  <li><a href="#disk-usage-i-before-analysis" id="toc-disk-usage-i-before-analysis" class="nav-link" data-scroll-target="#disk-usage-i-before-analysis">Disk Usage I — Before analysis</a></li>
  <li><a href="#fastq-scan" id="toc-fastq-scan" class="nav-link" data-scroll-target="#fastq-scan">fastq-scan</a></li>
  <li><a href="#fastqc" id="toc-fastqc" class="nav-link" data-scroll-target="#fastqc">FastQC</a></li>
  <li><a href="#fastp" id="toc-fastp" class="nav-link" data-scroll-target="#fastp">fastp</a></li>
  </ul></li>
  <li><a href="#identifying-contamination" id="toc-identifying-contamination" class="nav-link" data-scroll-target="#identifying-contamination">4.1.4 Identifying contamination</a>
  <ul class="collapse">
  <li><a href="#kraken-2" id="toc-kraken-2" class="nav-link" data-scroll-target="#kraken-2">Kraken 2</a></li>
  <li><a href="#bracken" id="toc-bracken" class="nav-link" data-scroll-target="#bracken">Bracken</a></li>
  <li><a href="#producing-a-more-friendly-species-composition-file" id="toc-producing-a-more-friendly-species-composition-file" class="nav-link" data-scroll-target="#producing-a-more-friendly-species-composition-file">Producing a more friendly species composition file</a></li>
  <li><a href="#multiqc" id="toc-multiqc" class="nav-link" data-scroll-target="#multiqc">MultiQC</a></li>
  </ul></li>
  <li><a href="#qc-bash-script-putting-it-all-together" id="toc-qc-bash-script-putting-it-all-together" class="nav-link" data-scroll-target="#qc-bash-script-putting-it-all-together">4.1.5 QC bash script: Putting it all together</a>
  <ul class="collapse">
  <li><a href="#running-multiple-samples-with-a-simple-bash-script" id="toc-running-multiple-samples-with-a-simple-bash-script" class="nav-link" data-scroll-target="#running-multiple-samples-with-a-simple-bash-script">Running multiple samples with a simple bash script</a></li>
  <li><a href="#disk-usage-ii-cleaning-up-after-analysis" id="toc-disk-usage-ii-cleaning-up-after-analysis" class="nav-link" data-scroll-target="#disk-usage-ii-cleaning-up-after-analysis">Disk Usage II — Cleaning up after analysis</a></li>
  </ul></li>
  <li><a href="#deactivate-qc-environment" id="toc-deactivate-qc-environment" class="nav-link" data-scroll-target="#deactivate-qc-environment">4.1.6 deactivate <code>qc</code> environment</a></li>
  <li><a href="#credit" id="toc-credit" class="nav-link" data-scroll-target="#credit">4.1.7 Credit</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">4.1 Sequencing Quality Control</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p><strong>Teaching: 90 min</strong> || <strong>Exercises: 20 min</strong></p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Questions:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>How do you perform basic statistics to check the quality of next generation sequence reads?</li>
<li>How do you identify contaminants in your sequences?</li>
<li>What are the various tools used for carrying out quality control?</li>
</ul>
</div>
</div>
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Learning Objectives:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>To perform a QC assessment of high throughput next generation sequence data</li>
<li>Interpret and critically evaluate data quality reports</li>
<li>To identify possible contamination in high throughput sequence data</li>
<li>Run simple scripts to achieve quality control of your genomic data</li>
</ul>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Key Points:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Before analysing your next generation sequencing data, it is key to quality control the data and only carry on with genomes that pass quality control checks</li>
<li>Best practice quality control assessments include:
<ul>
<li>Base quality check</li>
<li>Identifying mismatches</li>
<li>GC content and bias checks</li>
<li>False insertions and deletions</li>
<li>Identifying contamination</li>
</ul></li>
<li>Best practice quality control tools for performing the quality checks include
<ul>
<li><a href="https://github.com/rpetit3/fastq-scan">fastq-scan</a></li>
<li><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a></li>
<li><a href="https://github.com/OpenGene/fastp">fastp</a></li>
<li><a href="https://github.com/DerrickWood/kraken2">Kraken 2</a></li>
<li><a href="https://github.com/jenniferlu717/Bracken">Bracken</a></li>
<li><a href="https://github.com/ewels/MultiQC">MultiQC</a></li>
</ul></li>
<li>It is a good practice to clean up your directory as you proceed from analysis to analysis to avoid getting the error message that tells you <code>you are running out of space/memory</code>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">4.1.1 Background</h2>
<p>Before we delve into having a look at our own genomic data. Lets take some minutes to explore what to look out for when performing <strong>Q</strong>uality <strong>C</strong>ontrol <strong>(QC)</strong> checks on our sequences. For this course, we will largely focus on next generation sequences obtained from Illumina sequencers. As you may already know from the previous lesson, the main output files expected from our Illumina sequencer are <code>.fastq</code> files.</p>
<section id="qc-assessment-of-ngs-data" class="level3">
<h3 class="anchored" data-anchor-id="qc-assessment-of-ngs-data">QC assessment of NGS data</h3>
<p>As you may already know, <strong>QC</strong> is an important part of any analysis. In this section we are going to look at some of the metrics and graphs that can be used to assess the QC of NGS data.</p>
<section id="base-quality" class="level4">
<h4 class="anchored" data-anchor-id="base-quality">Base quality</h4>
<p><a href="https://en.wikipedia.org/wiki/Illumina_dye_sequencing">Illumina sequencing</a> technology relies on sequencing by synthesis. One of the most common problems with this is <strong>dephasing</strong>. For each sequencing cycle, there is a possibility that the replication machinery slips and either incorporates more than one nucleotide or perhaps misses to incorporate one at all. The more cycles that are run (i.e.&nbsp;the longer the read length gets), the greater the accumulation of these types of errors gets. This leads to a heterogeneous population in the cluster, and a decreased signal purity, which in turn reduces the precision of the base calling. The figure below shows an example of this.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/base_qual.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Base Quality</figcaption><p></p>
</figure>
</div>
<p>Because of dephasing, it is possible to have high-quality data at the beginning of the read but really low-quality data towards the end of the read. In those cases you can decide to trim off the low-quality reads, for example using a tool called <a href="http://www.usadellab.org/cms/?page=trimmomatic">Trimmomatic</a>. In this workshop, we will do this using the tool <a href="https://www.ncbi.nlm.nih.gov/pubmed/30423086/"><code>fastp</code></a>. In addition to trimming low quality reads, <code>fastp</code>will also be used to trim off Illumina adapter/primer sequences.</p>
<p>The figures below shows an example of a high-quality read data (left) and a poor quality read data (right).</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/base_qual_pass.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">High-quality read data</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/base_qual_fail.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Poor quality read data</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>Base Quality Comparison</p>
</div>
</div>
</div>
<p>In addition to <strong>Phasing noise</strong> and <strong>signal decay</strong> resulting from dephasing issues described above, there are several different reasons for a base to be called incorrectly. You can lookup these later by clicking <a href="10.1093/bib/bbq077">here</a>.</p>
</section>
<section id="mismatches-per-cycle" class="level4">
<h4 class="anchored" data-anchor-id="mismatches-per-cycle">Mismatches per cycle</h4>
<p>Aligning reads to a high-quality reference genome can provide insight to the quality of a sequencing run by showing you the mismatches to the reference sequence. This can help you detect cycle-specific errors. Mismatches can occur due to two main causes, sequencing errors and differences between your sample and the reference genome, which is important to bear in mind when interpreting mismatch graphs. The figures below show an example of a good run (top) and a bad one (bottom). In the first figure, the distribution of the number of mismatches is even between the cycles, which is what we would expect from a good run. However, in the second figure, two cycles stand out with a lot of mismatches compared to the other cycles.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/mismatch_per_cycle_pass.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Good run</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/mismatch_per_cycle_fail.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Poor run</figcaption><p></p>
</figure>
</div>
</section>
<section id="gc-bias" class="level4">
<h4 class="anchored" data-anchor-id="gc-bias">GC bias</h4>
<p>It is a good idea to compare the GC content of the reads against the expected distribution in a reference sequence. The GC content varies between species, so a shift in GC content like the one seen below (right image) could be an indication of sample contamination. In the left image below, we can see that the GC content of the sample is about the same as for the theoretical reference, at ~65%. However, in the right figure, the GC content of the sample shows two distribution, one is closer to 40% and the other closer to 65%, indicating that there is an issue with this sample — a possible missed sample. Note that, suspecting contamination is perfectly fine for the species we are dealing with (MTBC). For other bacteria where there may be possibility of gene transfer, one can imagine that, such a situation may be from inheriting some plasmids that have a totally different GC content to the bacteria chromosome (<em>This is arguable though</em>).</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/gc_pass.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Single GC distribution</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/gc_fail.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Double GC distribution</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>Figure: Base Quality Comparison</p>
</div>
</div>
</div>
</section>
<section id="gc-content-by-cycle" class="level4">
<h4 class="anchored" data-anchor-id="gc-content-by-cycle">GC content by cycle</h4>
<p>Looking at the GC content per cycle can help detect if the adapter sequence was trimmed. For a random library, it is expected to be little to no difference between the different bases of a sequence run, so the lines in this plot should be parallel with each other like in the first of the two figures below. In the second of the figures, the initial spikes are likely due to adapter sequences that have not been removed.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/acgt_per_cycle_pass.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Good run</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/acgt_per_cycle_fail.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Poor run</figcaption><p></p>
</figure>
</div>
</section>
<section id="insert-size" class="level4">
<h4 class="anchored" data-anchor-id="insert-size">Insert size</h4>
<p>For paired-end sequencing the size of DNA fragments also matters. In the first of the examples below, the insert size peaks around 440 bp. In the second however, there is also a peak at around 200 bp. This indicates that there was an issue with the fragment size selection during library prep.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/insert_size_pass.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Good run</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/insert_size_fail.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Poor run</figcaption><p></p>
</figure>
</div>
</section>
<section id="insertionsdeletions-per-cycle" class="level4">
<h4 class="anchored" data-anchor-id="insertionsdeletions-per-cycle">Insertions/Deletions per cycle</h4>
<p>Sometimes, air bubbles occur in the flow cell, which can manifest as false indels. The spike in the second image provides an example of how this can look.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/indels-per-cycle.pass.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Good run</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/indels-per-cycle.fail.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Poor run</figcaption><p></p>
</figure>
</div>
<p>In addition to the QC plots you’ve encountered so far, there are other metrics that are generated with very powerful tools. For this workshop, we will explore these quality metrics with the help of <code>fastq-scan</code> and <code>FastQC</code> tools. It is often not a good practice to carry on analysis on samples that are contaminated with sequences from other species. We will identify contamination using either one of two ways. As earlier mentioned, the GC content varies between species, so a shift in GC content could be an indication of sample contamination. One other way of identifying sample contamination is by using specialized tools to determine/predict the species composition of your sample. For this course, we will determine species composition using the <code>Kraken 2</code> database.</p>
</section>
</section>
</section>
<section id="change-to-the-qc-directory-and-activate-the-qc-environment" class="level2">
<h2 class="anchored" data-anchor-id="change-to-the-qc-directory-and-activate-the-qc-environment">4.1.2 Change to the <code>QC</code> directory and activate the <code>qc</code> environment</h2>
<p>Before we start, change into the <code>QC/</code> directory and activate the <code>qc</code> environment:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/Desktop/workshop_files_Bact_Genomics_2023/04_QC/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mamba</span> activate qc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="generating-qc-stats-and-metrics" class="level2">
<h2 class="anchored" data-anchor-id="generating-qc-stats-and-metrics">4.1.3 Generating QC stats and metrics</h2>
<p>We are now ready to explore some quality metrics on our sequence data.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tools used and how to get help
</div>
</div>
<div class="callout-body-container callout-body">
<p>This tutorial uses <a href="https://github.com/rpetit3/fastq-scan">fastq-scan</a>, <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a>, <a href="https://github.com/OpenGene/fastp">fastp</a>, <a href="https://github.com/DerrickWood/kraken2">Kraken 2</a>, <a href="https://github.com/jenniferlu717/Bracken">Bracken</a> and <a href="https://github.com/ewels/MultiQC">MultiQC</a>, which have been preinstalled for you in a virtual environment called <code>qc</code>. This is to help speed up the pace of the workshop. You can lookup the setup page for how to install these tools later. In a latter chapter of the course, you will also be introduced to how to set up these virtual environments and explore its usefulness. For each tool, to get help messages that describe how they are used, you can simply type the name of the tool and hit enter. This only works if you activate the environment in which the tools have already been installed. Alternatively, you can use the <strong>help</strong> flag <code>-help</code> or <code>-h</code> as appropriate.</p>
</div>
</div>
<section id="disk-usage-i-before-analysis" class="level3">
<h3 class="anchored" data-anchor-id="disk-usage-i-before-analysis">Disk Usage I — Before analysis</h3>
<p>Before we start investigating our genomic sequences, let’s pause and check the space of our current working directory.</p>
<p>You can do this with the <strong>d</strong>isk <strong>u</strong>sage <code>du</code> command</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">du</span> <span class="at">-h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Current Disk Space In QC Directory
</summary>
~1.3G
</details>
<p>Now, keep this value in mind, we will come back to it at the end of the chapter.</p>
</section>
<section id="fastq-scan" class="level3">
<h3 class="anchored" data-anchor-id="fastq-scan"><a href="https://github.com/rpetit3/fastq-scan">fastq-scan</a></h3>
<p><code>fastq-scan</code> reads a FASTQ from STDIN and outputs summary statistics (read lengths, per-read qualities, per-base qualities) in JSON format.</p>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Help
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do this to get the help information for fastq-scan</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastq-scan</span> <span class="at">-h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Usage: cat FASTQ | fastq-scan [options]
Version: 1.0.0

Optional arguments:
 -g INT   Genome size for calculating estimated sequencing coverage. (Default 1)
 -p INT   ASCII offset for input quality scores, can be 33 or 64. (Default 33)  
 -q       Print only the QC stats, do not print read lengths or per-base quality scores
 -v       Print version information and exit
 -h       Show this message and exit</code></pre>
</div>
</div>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Usage
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>fastq-scan</code> reads from STDIN, so pretty much any FASTQ output can be piped into <code>fastq-scan</code>. There are a few things to be aware of. It assumes that all FASTQ entries are the four line variant. Also, it has a PHRED offset (33 vs 64) guesser function. By default it is set to PHRED33, it could produce errors if there are not any PHRED33 or PHRED64 specific characters in the quality scores.</p>
</div>
</div>
<p>You can now go ahead and perform the <code>fastq-scan</code> with the below command.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Try this command out first. You may have to add <code>&lt;</code> after the <code>zcat</code> command depending on your OS. <code>zcat</code> works differently with different OS.</em></p>
<p>Do this to run the forward reads:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zcat</span> G26832_R1.fastq.gz <span class="kw">|</span> <span class="ex">fastq-scan</span> <span class="at">-g</span> 4300000 <span class="op">&gt;</span> G26832_R1_fastq-scan.json</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>And for the reverse reads:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zcat</span> G26832_R2.fastq.gz <span class="kw">|</span> <span class="ex">fastq-scan</span> <span class="at">-g</span> 4300000 <span class="op">&gt;</span> G26832_R2_fastq-scan.json</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>You should now see two new files generated in your current directory.</p>
<p>To see if the files have been created, use this command:</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">"fastq-scan.json"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>G26832_R1_fastq-scan.json
G26832_R2_fastq-scan.json</code></pre>
</div>
</div>
</div>
<p>To view the statistics for the forward reads use this command:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> G26832_R1_fastq-scan.json</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The file created is rather small, so you can afford to use <code>cat</code> to view the entire content. You may want to use <code>head</code> or <code>less</code> for huge files.</p>
</div>
</div>
<p>As you may have realized, the content of the output file doesn’t look friendly.</p>
<p>Let’s convert the <code>.json</code> files into a more friendly format, say <code>tsv</code>. You should know what <code>tsv</code> files are by now. If not, you can go back to the previous chapter on file-formats to equip yourself.</p>
<section id="parse-json-files-into-tsv-format" class="level4">
<h4 class="anchored" data-anchor-id="parse-json-files-into-tsv-format">Parse json files into tsv format</h4>
<p>We will run a simple python script to achieve this purpose. In your working directory, you will find a file named <code>fastq-scan_parser.py</code>. This is a simple python script that will do the job for us.</p>
<p>We can go ahead and execute that python script by running the command below:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> fastq-scan_parser.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You should now see another file generated in your directory called <code>fastq-scan_summary.tsv</code>. What the python script did was to extract the relevant information from all <code>.json</code> files in the working directory and convert them to a <code>tsv</code> file.</p>
<p>Now let’s go ahead and have a look at the <code>tsv</code> file with the command</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> fastq-scan_summary.tsv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>sample  total_bp    coverage    read_total  read_min    read_mean   read_std    read_median read_max    read_25th   read_75th   qual_min    qual_mean   qual_std    qual_max    qual_median qual_25th   qual_75th
G26832_R1   305515607   71.0501 3024907 101 101.0   0.0 101 101 101 101 14  35.2243 3.49844 37  37  35  37</code></pre>
<p>Alternatively, you can open the <code>tsv</code> file with any appropriate GUI software (excel or libreoffice)</p>
</section>
</section>
<section id="fastqc" class="level3">
<h3 class="anchored" data-anchor-id="fastqc"><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a></h3>
<p><code>FastQC</code> is a program designed to spot potential problems in high throughput sequencing datasets. It runs a set of analyses on one or more raw sequence files in fastq or bam format and produces a report which summarises the results. It provides a modular set of analyses which you can use to give a quick impression of whether your data has any problems of which you should be aware before doing any further analysis.</p>
<p>FastQC will highlight any areas where the library looks unusual and where you should take a closer look. The program is not tied to any specific type of sequencing technique and can be used to look at libraries coming from a large number of different experiment types (Genomic Sequencing, ChIP-Seq, RNA-Seq, BS-Seq etc etc).</p>
<p>The main functions of FastQC are:</p>
<ul>
<li>Import of data from BAM, SAM or FastQ files (any variant)</li>
<li>Providing a quick overview to tell you in which areas there may be problems</li>
<li>Summary graphs and tables to quickly assess your data</li>
<li>Export of results to an HTML based permanent report</li>
<li>Offline operation to allow automated generation of reports without running the interactive application</li>
</ul>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Help
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do this to get the help information for FastQC</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastqc</span> <span class="at">-h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>
            FastQC - A high throughput sequence QC analysis tool

SYNOPSIS

        fastqc seqfile1 seqfile2 .. seqfileN

    fastqc [-o output dir] [--(no)extract] [-f fastq|bam|sam] 
           [-c contaminant file] seqfile1 .. seqfileN

DESCRIPTION

    FastQC reads a set of sequence files and produces from each one a quality
    control report consisting of a number of different modules, each one of 
    which will help to identify a different potential type of problem in your
    data.
    
    If no files to process are specified on the command line then the program
    will start as an interactive graphical application.  If files are provided
    on the command line then the program will run with no user interaction
    required.  In this mode it is suitable for inclusion into a standardised
    analysis pipeline.
    
    The options for the program as as follows:
    
    -h --help       Print this help file and exit
    
    -v --version    Print the version of the program and exit
    
    -o --outdir     Create all output files in the specified output directory.
                    Please note that this directory must exist as the program
                    will not create it.  If this option is not set then the 
                    output file for each sequence file is created in the same
                    directory as the sequence file which was processed.
                    
    --casava        Files come from raw casava output. Files in the same sample
                    group (differing only by the group number) will be analysed
                    as a set rather than individually. Sequences with the filter
                    flag set in the header will be excluded from the analysis.
                    Files must have the same names given to them by casava
                    (including being gzipped and ending with .gz) otherwise they
                    won't be grouped together correctly.
...</code></pre>
</div>
</div>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Usage
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>FastQC</code> reads a set of sequence files and produces from each one a quality control report consisting of a number of different modules, each one of which will help to identify a different potential type of problem in your data. If no files to process are specified on the command line then the program will start as an interactive graphical application. If files are provided on the command line then the program will run with no user interaction required. In this mode it is suitable for inclusion into a standardised analysis pipeline.</p>
<p>The general format of the command is:</p>
<pre><code>fastqc [-o output dir] [--(no)extract] [-f fastq|bam|sam] [-c contaminant file] seqfile1 seqfile2 .. seqfileN</code></pre>
</div>
</div>
<p>You can now go ahead and perform the <code>fastQC</code> with the below command.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do this to run the forward reads:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastqc</span> <span class="at">--threads</span> 4 G26832_R1.fastq.gz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Started analysis of G26832_R1.fastq.gz
Approx 5% complete for G26832_R1.fastq.gz
Approx 10% complete for G26832_R1.fastq.gz
Approx 15% complete for G26832_R1.fastq.gz
Approx 20% complete for G26832_R1.fastq.gz
Approx 25% complete for G26832_R1.fastq.gz
...</code></pre>
<p>And for the reverse reads:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastqc</span> <span class="at">--threads</span> 4 G26832_R2.fastq.gz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Output
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you specified an output <code>-o</code> directory then you should look out for that file being created in that directory. For our situation, we didn’t specify any output directory so the result will just be in the current directory. You should now see two new files generated in your current directory.</p>
</div>
</div>
How do you tell which file has been recently produced?
<details>
<summary>
Hint
</summary>
<p>Perform a simple <code>ls</code> command with the arguments <code>-lhrt</code> and the last file in the output should be the most recent.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-lhrt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>We are interested in the one that ends with <code>.html</code>. Go ahead and open it. Being an <code>.html</code> file, it will prefer to open in a browser, and that’s just how we want to make sense out of it.</p>
<p>We have already seen some of the content of the output file from the background to this chapter. However, this time, let’s look at a few more and also with some more details.</p>
<section id="basic-statistics" class="level4">
<h4 class="anchored" data-anchor-id="basic-statistics"><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/1%20Basic%20Statistics.html">Basic Statistics</a></h4>
<p>The first information you encounter is the basic statistics. The Basic Statistics module generates some simple composition statistics for the file analysed.</p>
<ul>
<li>Filename: The original filename of the file which was analysed</li>
<li>File type: Says whether the file appeared to contain actual base calls or colorspace data which had to be converted to base calls</li>
<li>Encoding: Says which ASCII encoding of quality values was found in this file.</li>
<li>Total Sequences: A count of the total number of sequences processed. There are two values reported, actual and estimated. At the moment these will always be the same.</li>
<li>Filtered Sequences: If running in Casava mode sequences flagged to be filtered will be removed from all analyses. The number of such sequences removed will be reported here. The total sequences count above will not include these filtered sequences and will the number of sequences actually used for the rest of the analysis.</li>
<li>Sequence Length: Provides the length of the shortest and longest sequence in the set. If all sequences are the same length only one value is reported.</li>
<li>%GC: The overall %GC of all bases in all sequences</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/fastqc_basic_stats.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">FastQC Basic Statistics</figcaption><p></p>
</figure>
</div>
</section>
<section id="per-base-sequence-quality" class="level4">
<h4 class="anchored" data-anchor-id="per-base-sequence-quality"><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/2%20Per%20Base%20Sequence%20Quality.html">Per Base Sequence Quality</a></h4>
<p>The plot shows an overview of the range of quality values across all bases at each position in the FastQ file.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="..fig/per_base_sequence_quality.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Per Base Sequence Quality</figcaption><p></p>
</figure>
</div>
<p>For each position a BoxWhisker type plot is drawn. The elements of the plot are as follows: - The central red line is the median value - The yellow box represents the inter-quartile range (25-75%) - The upper and lower whiskers represent the 10% and 90% points - The blue line represents the mean quality</p>
<p>The y-axis on the graph shows the quality scores. The higher the score the better the base call. The background of the graph divides the y-axis into very good quality calls (green), calls of reasonable quality (orange), and calls of poor quality (red). The quality of calls on most platforms will degrade as the run progresses, so it is common to see base calls falling into the orange area towards the end of a read.</p>
<p>It should be mentioned that there are number of different ways to encode a quality score in a FastQ file. FastQC attempts to automatically determine which encoding method was used, but in some very limited datasets it is possible that it will guess this incorrectly (ironically only when your data is universally very good!). The title of the graph will describe the encoding FastQC thinks your file used.</p>
<p><strong><em>NB.</em></strong> Results from this module will not be displayed if your input is a BAM/SAM file in which quality scores have not been recorded.</p>
<p><strong><em>Warning</em></strong> A warning will be issued if the lower quartile for any base is less than 10, or if the median for any base is less than 25.</p>
<p><strong><em>Failure</em></strong> This module will raise a failure if the lower quartile for any base is less than 5 or if the median for any base is less than 20.</p>
<details>
<summary>
Common reasons for warnings
</summary>
<p>The most common reason for warnings and failures in this module is a general degradation of quality over the duration of long runs. In general sequencing chemistry degrades with increasing read length and for long runs you may find that the general quality of the run falls to a level where a warning or error is triggered.</p>
<p>If the quality of the library falls to a low level then the most common remedy is to perform quality trimming where reads are truncated based on their average quality. For most libraries where this type of degradation has occurred you will often be simultaneously running into the issue of adapter read-through so a combined adapter and quality trimming step is often employed.</p>
<p>Another possibility is that a warn / error is triggered because of a short loss of quality earlier in the run, which then recovers to produce later good quality sequence. This can happen if there is a transient problem with the run (bubbles passing through a flow cell for example). You can normally see this type of error by looking at the per-tile quality plot (if available for your platform). In these cases trimming is not advisable as it will remove later good sequence, but you might want to consider masking bases during subsequent mapping or assembly.</p>
<p>If your library has reads of varying length then you can find a warning or error is triggered from this module because of very low coverage for a given base range. Before committing to any action, check how many sequences were responsible for triggering an error by looking at the sequence length distribution module results.</p>
</details>
</section>
<section id="per-sequence-quality-scores" class="level4">
<h4 class="anchored" data-anchor-id="per-sequence-quality-scores"><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/3%20Per%20Sequence%20Quality%20Scores.html">Per Sequence Quality Scores</a></h4>
<p>The per sequence quality score report allows you to see if a subset of your sequences have universally low quality values. It is often the case that a subset of sequences will have universally poor quality, often because they are poorly imaged (on the edge of the field of view etc), however these should represent only a small percentage of the total sequences.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/per_sequence_quality_scores.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Per Sequence Quality Scores</figcaption><p></p>
</figure>
</div>
<p>If a significant proportion of the sequences in a run have overall low quality then this could indicate some kind of systematic problem - possibly with just part of the run (for example one end of a flow cell).</p>
<p><strong><em>NB.</em></strong> Results from this module will not be displayed if your input is a BAM/SAM file in which quality scores have not been recorded.</p>
<p><strong><em>Warning</em></strong> A warning is raised if the most frequently observed mean quality is below 27 - this equates to a 0.2% error rate.</p>
<p><strong><em>Failure</em></strong> An error is raised if the most frequently observed mean quality is below 20 - this equates to a 1% error rate.</p>
<details>
<summary>
Common reasons for warnings
</summary>
This module is generally fairly robust and errors here usually indicate a general loss of quality within a run. For long runs this may be alleviated through quality trimming. If a bi-modal, or complex distribution is seen then the results should be evaluated in concert with the per-tile qualities (if available) since this might indicate the reason for the loss in quality of a subset of sequences.
</details>
</section>
<section id="per-base-sequence-content" class="level4">
<h4 class="anchored" data-anchor-id="per-base-sequence-content"><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/4%20Per%20Base%20Sequence%20Content.html">Per Base Sequence Content</a></h4>
<p>Per Base Sequence Content plots out the proportion of each base position in a file for which each of the four normal DNA bases has been called.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/per_base_sequence_content.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Per Base Sequence Content</figcaption><p></p>
</figure>
</div>
<p>In a random library you would expect that there would be little to no difference between the different bases of a sequence run, so the lines in this plot should run parallel with each other. The relative amount of each base should reflect the overall amount of these bases in your genome, but in any case they should not be hugely imbalanced from each other.</p>
<p>It’s worth noting that some types of library will always produce biased sequence composition, normally at the start of the read. Libraries produced by priming using random hexamers (including nearly all RNA-Seq libraries) and those which were fragmented using transposases inherit an intrinsic bias in the positions at which reads start. This bias does not concern an absolute sequence, but instead provides enrichment of a number of different K-mers at the 5’ end of the reads. Whilst this is a true technical bias, it isn’t something which can be corrected by trimming and in most cases doesn’t seem to adversely affect the downstream analysis. It will however produce a warning or error in this module.</p>
<p><strong><em>Warning</em></strong> This module issues a warning if the difference between A and T, or G and C is greater than 10% in any position.</p>
<p><strong><em>Failure</em></strong> This module will fail if the difference between A and T, or G and C is greater than 20% in any position.</p>
<details>
<summary>
Common reasons for warnings
</summary>
<p>There are a number of common scenarios which would elicit a warning or error from this module.</p>
Overrepresented sequences: If there is any evidence of overrepresented sequences such as adapter dimers or rRNA in a sample then these sequences may bias the overall composition and their sequence will emerge from this plot. Biased fragmentation: Any library which is generated based on the ligation of random hexamers or through tagmentation should theoretically have good diversity through the sequence, but experience has shown that these libraries always have a selection bias in around the first 12bp of each run. This is due to a biased selection of random primers, but doesn’t represent any individually biased sequences. Nearly all RNA-Seq libraries will fail this module because of this bias, but this is not a problem which can be fixed by processing, and it doesn’t seem to adversely affect the ability to measure expression. Biased composition libraries: Some libraries are inherently biased in their sequence composition. The most obvious example would be a library which has been treated with sodium bisulphite which will then have converted most of the cytosines to thymines, meaning that the base composition will be almost devoid of cytosines and will thus trigger an error, despite this being entirely normal for that type of library If you are analysing a library which has been aggressively adapter trimmed then you will naturally introduce a composition bias at the end of the reads as sequences which happen to match short stretches of adapter are removed, leaving only sequences which do not match. Sudden deviations in composition at the end of libraries which have undergone aggressive trimming are therefore likely to be spurious.
</details>
</section>
<section id="per-base-n-content" class="level4">
<h4 class="anchored" data-anchor-id="per-base-n-content"><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/6%20Per%20Base%20N%20Content.html">Per Base N Content</a></h4>
<p>If a sequencer is unable to make a base call with sufficient confidence then it will normally substitute an N rather than a conventional base] call</p>
<p>This module plots out the percentage of base calls at each position for which an N was called.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/per_base_N_content.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Per Base N Content</figcaption><p></p>
</figure>
</div>
<p>It’s not unusual to see a very low proportion of Ns appearing in a sequence, especially nearer the end of a sequence. However, if this proportion rises above a few percent it suggests that the analysis pipeline was unable to interpret the data well enough to make valid base calls.</p>
<p><strong><em>Warning</em></strong> This module raises a warning if any position shows an N content of &gt;5%.</p>
<p><strong><em>Failure</em></strong> This module will raise an error if any position shows an N content of &gt;20%.</p>
<details>
<summary>
Common reasons for warnings
</summary>
<p>The most common reason for the inclusion of significant proportions of Ns is a general loss of quality, so the results of this module should be evaluated in concert with those of the various quality modules. You should check the coverage of a specific bin, since it’s possible that the last bin in this analysis could contain very few sequences, and an error could be prematurely triggered in this case.</p>
Another common scenario is the incidence of a high proportions of N at a small number of positions early in the library, against a background of generally good quality. Such deviations can occur when you have very biased sequence composition in the library to the point that base callers can become confused and make poor calls. This type of problem will be apparent when looking at the per-base sequence content results.
</details>
</section>
</section>
<section id="fastp" class="level3">
<h3 class="anchored" data-anchor-id="fastp"><a href="https://github.com/OpenGene/fastp">fastp</a></h3>
<p>click <a href="https://www.ncbi.nlm.nih.gov/pubmed/30423086/">here</a> to view the publication on <a href="https://www.ncbi.nlm.nih.gov/pubmed/30423086/">fastp</a> <code>fastp</code> is a tool designed to provide fast all-in-one pre-processing for FastQ files.</p>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Help
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do this to get the help information for fastp</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastp</span> <span class="at">--help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>fastp: an ultra-fast all-in-one FASTQ pre-processor
version 0.23.2
usage: fastp [options] ... 
options:
  -i, --in1                            read1 input file name (string [=])
  -o, --out1                           read1 output file name (string [=])
  -I, --in2                            read2 input file name (string [=])
  -O, --out2                           read2 output file name (string [=])
      --unpaired1                      for PE input, if read1 passed QC but read2 not, it will be written to unpaired1. Default is to discard it. (string [=])
      --unpaired2                      for PE input, if read2 passed QC but read1 not, it will be written to unpaired2. If --unpaired2 is same as --unpaired1 (default mode), both unpaired reads will be written to this same file. (string [=])
...</code></pre>
</div>
</div>
<section id="features" class="level4">
<h4 class="anchored" data-anchor-id="features">Features</h4>
<ul>
<li>comprehensive quality profiling for both before and after filtering data (quality - curves, base contents, KMER, Q20/Q30, GC Ratio, duplication, adapter contents…)</li>
<li>filter out bad reads (too low quality, too short, or too many N…)</li>
<li>cut low quality bases for per read in its 5’ and 3’ by evaluating the mean quality - from a sliding window (like Trimmomatic but faster).</li>
<li>trim all reads in front and tail</li>
<li>cut adapters. Adapter sequences can be automatically detected, which means you don’t have to input the adapter sequences to trim them.</li>
<li>correct mismatched base pairs in overlapped regions of paired end reads, if one base is with high quality while the other is with ultra low quality</li>
<li>trim polyG in 3’ ends, which is commonly seen in NovaSeq/NextSeq data. Trim polyX in 3’ ends to remove unwanted polyX tailing (i.e.&nbsp;polyA tailing for mRNA-Seq data)</li>
<li>preprocess unique molecular identifier (UMI) enabled data, shift UMI to sequence name.</li>
<li>report JSON format result for further interpreting.</li>
<li>visualize quality control and filtering results on a single HTML page (like FASTQC - but faster and more informative).</li>
<li>split the output to multiple files (0001.R1.gz, 0002.R1.gz…) to support parallel - processing. Two modes can be used, limiting the total split file number, or limiting the lines of each split file.</li>
<li>support long reads (data from PacBio / Nanopore devices).</li>
<li>support reading from STDIN and writing to STDOUT</li>
<li>support interleaved input</li>
<li>support ultra-fast FASTQ-level deduplication</li>
</ul>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Usage
</div>
</div>
<div class="callout-body-container callout-body">
<p>for single end data (not compressed)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastp</span> <span class="at">-i</span> in.fq <span class="at">-o</span> out.fq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>for paired end data (gzip compressed)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastp</span> <span class="at">-i</span> in_R1.fq.gz <span class="at">-I</span> in_R2.fq.gz <span class="at">-o</span> out_R1.fq.gz <span class="at">-O</span> out_R2.fq.gz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>By default, the HTML report is saved to fastp.html (can be specified with -h option), and the JSON report is saved to fastp.json (can be specified with -j option).</p>
</div>
</div>
<p>You can now go ahead and perform the <code>fastp</code> with the below command. We will perform the run on both reads.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastp</span> <span class="at">--cut_front</span> <span class="at">--cut_tail</span> <span class="at">--trim_poly_x</span> <span class="at">--cut_mean_quality</span> 30 <span class="at">--qualified_quality_phred</span> 30 <span class="at">--unqualified_percent_limit</span> 10 <span class="at">--length_required</span> 50 <span class="at">--in1</span> G26832_R1.fastq.gz <span class="at">--in2</span> G26832_R2.fastq.gz <span class="at">--out1</span> G26832_R1.trim.fastq.gz <span class="at">--out2</span> G26832_R2.trim.fastq.gz <span class="at">--json</span> G26832_fastp.json <span class="at">--html</span> G26832_fastp.html <span class="at">--thread</span> 4 <span class="at">--detect_adapter_for_pe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Detecting adapter sequence for read1...
&gt;Illumina TruSeq Adapter Read 1
AGATCGGAAGAGCACACGTCTGAACTCCAGTCA

Detecting adapter sequence for read2...
&gt;Illumina TruSeq Adapter Read 2
AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT

Read1 before filtering:
total reads: 3024907
total bases: 305515607
Q20 bases: 291946114(95.5585%)
Q30 bases: 278924986(91.2965%)

Read2 before filtering:
total reads: 3024907
total bases: 305515607
Q20 bases: 283844973(92.9069%)
Q30 bases: 265510454(86.9057%)

Read1 after filtering:
total reads: 2042550
total bases: 204034659
Q20 bases: 203578565(99.7765%)
Q30 bases: 202244612(99.1227%)
...</code></pre>
<p>You can also read out what is printed out on the terminal as a log file by passing the output to a textfile named <code>fastp.log</code>. This way, you don’t see all the long print out on the terminal.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastp</span> <span class="at">--cut_front</span> <span class="at">--cut_tail</span> <span class="at">--trim_poly_x</span> <span class="at">--cut_mean_quality</span> 30 <span class="at">--qualified_quality_phred</span> 30 <span class="at">--unqualified_percent_limit</span> 10 <span class="at">--length_required</span> 50 <span class="at">--in1</span> G26832_R1.fastq.gz <span class="at">--in2</span> G26832_R2.fastq.gz <span class="at">--out1</span> G26832_R1.trim.fastq.gz <span class="at">--out2</span> G26832_R2.trim.fastq.gz <span class="at">--json</span> G26832_fastp.json <span class="at">--html</span> G26832_fastp.html <span class="at">--thread</span> 4 <span class="at">--detect_adapter_for_pe</span> <span class="op">&gt;</span> fastp.log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>You should now see four new files generated in your current directory.</p>
<pre><code>G26832_R2.trim.fastq.gz
G26832_R1.trim.fastq.gz
G26832_fastp.json
G26832_fastp.html</code></pre>
<p>Now let’s go ahead and see what our output looks like by opening the <code>G26832_fastp.html</code> file. You should be able to interpret the output by now.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/fastp_summary.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Summary of fastp report</figcaption><p></p>
</figure>
</div>
<p>Let’s have a look at the quality of both reads before and after trimming. What obvious differences do you notice.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/fastp_before_filtering_read1_quality.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Read Quality before filtering</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/fastp_after_filtering_read1_quality.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Read Quality after filtering</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>Read Quality before and after <code>fastp</code> processing</p>
</div>
</div>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/fastp_before_filtering_read1_base_content.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Base content quality before filtering</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/fastp_after_filtering_read1_base_content.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Base content quality after filtering</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>Base Content Quality before and after <code>fastp</code> processing</p>
</div>
</div>
</div>
<!--FIXME: The difference in the base quality content is not that obvious. You may want to change it later-->
</section>
</section>
</section>
<section id="identifying-contamination" class="level2">
<h2 class="anchored" data-anchor-id="identifying-contamination">4.1.4 Identifying contamination</h2>
<p>It is always a good idea to check that your data is from the species you expect it to be. A very useful tool for this is Kraken. In this workshop we will go through how you can use Kraken to check your samples for contamination.</p>
<section id="kraken-2" class="level3">
<h3 class="anchored" data-anchor-id="kraken-2"><a href="https://github.com/DerrickWood/kraken2">Kraken 2</a></h3>
<p>click <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6883579/#CR41">here</a> to view the publication on <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6883579/#CR41">Kraken 2</a> <code>kraken</code> is a taxonomic sequence classifier that assigns taxonomic labels to DNA sequences. Kraken examines the <code>k-mers</code> within a query sequence and uses the information within those <code>k-mers</code> to query a database. That database maps <code>k-mers</code> to the lowest common ancestor (LCA) of all genomes known to contain a given <code>k-mer</code>.</p>
<p>The first version of Kraken used a large indexed and sorted list of -mer/LCA pairs as its database. While fast, the large memory requirements posed some problems for users, and so Kraken 2 was created to provide a solution to those problems.</p>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Help
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do this to get the help information for Kraken 2</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Kraken2</span> <span class="at">--help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Usage: kraken2 [options] &lt;filename(s)&gt;

Options:
  --db NAME               Name for Kraken 2 DB
                          (default: none)
  --threads NUM           Number of threads (default: 1)
  --quick                 Quick operation (use first hit or hits)
  --unclassified-out FILENAME
                          Print unclassified sequences to filename
  --classified-out FILENAME
                          Print classified sequences to filename
  --output FILENAME       Print output to filename (default: stdout); "-" will
                          suppress normal output
  --confidence FLOAT      Confidence score threshold (default: 0.0); must be
                          in [0, 1].
...</code></pre>
</div>
</div>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Usage
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>Kraken 2</code> is run on a database. You don’t have to worry about the database for now. All has been setup for you. To set up the database yourself, visit the <a href="../../setup.html">setup page</a></p>
<p>The general synthax for running <code>Kraken 2</code> is:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kraken2</span> <span class="at">--db</span> <span class="va">$DBNAME</span> [other_options] <span class="op">&lt;</span>filename<span class="er">(</span><span class="ex">s</span><span class="kw">)</span><span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>To run <code>Kraken 2</code>, you need to provide the path to the database. By default, the input files are assumed to be in FASTA format, so in this case we also need to tell Kraken that our input files are in FASTQ format, gzipped, and that they are paired end reads.</p>
<p>You can now go ahead and run <code>Kraken 2</code> with the below command.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Take note of these: 1. You have to specify the directory to the database 2. Our input files will be the trimmed fastq sequences from the fastp analysis.</p>
<p>Do this to run Kraken 2: <!--FIXME: specify the correct output directory per the course environment--></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kraken2</span> <span class="at">--db</span> ../database/minikraken2_v1_8GB <span class="at">--threads</span> 4 <span class="at">--unclassified-out</span> G26832.unclassified#.fastq <span class="at">--classified-out</span> G26832.classified#.fastq <span class="at">--report</span> G26832.kraken2.report.txt <span class="at">--output</span> G26832.kraken2.out <span class="at">--gzip-compressed</span> <span class="at">--report-zero-counts</span> <span class="at">--paired</span> G26832_R1.trim.fastq.gz G26832_R2.trim.fastq.gz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Loading database information... done.
2042550 sequences (407.73 Mbp) processed in 18.212s (6729.3 Kseq/m, 1343.29 Mbp/m).
  2038335 sequences classified (99.79%)
  4215 sequences unclassified (0.21%)</code></pre>
</div>
</div>
<p>You should now see some new files generated in your current directory. How many new files have been generated? Do you see that the <code>fastq</code> files are unzipped?</p>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Let’s save some disk space by zipping the four new <code>fastq</code> files created
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb34"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gzip</span> <span class="pp">*</span>.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>You can try to read the two kraken report output text files created, but I’m sure that won’t make real sense to you.</p>
<details>
<summary>
Quick look at Kraken 2 report
</summary>
<p>Run the command to have a quick look at the Kraken 2 report.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> <span class="at">-n</span> 20 G26832.kraken2.report.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
The six columns in this file are: - Percentage of reads covered by the clade rooted at this taxon - Number of reads covered by the clade rooted at this taxon - Number of reads assigned directly to this taxon - A rank code, indicating (U)nclassified, (D)omain, (K)ingdom, (P)hylum, (C)lass, (O)rder, (F)amily, (G)enus, or (S)pecies. All other ranks are simply ‘-’. - NCBI taxonomy ID - Scientific name
</details>
<p>Just like we did for the fastq-scan output, we will have to convert the Kraken 2 output to a more readable format. Before we do this, we will have to perform one more analysis on our sample. The Kraken 2 often does not provide exhaustive results. To re-estimate taxonomic abundance of the samples we have to do this with another tool called <code>Bracken</code> using the output of Kraken 2.</p>
</section>
<section id="bracken" class="level3">
<h3 class="anchored" data-anchor-id="bracken"><a href="https://github.com/jenniferlu717/Bracken">Bracken</a></h3>
<p>click <a href="https://peerj.com/articles/cs-104/">here</a> to view the publication on <a href="https://peerj.com/articles/cs-104/">Bracken</a> Bracken is a companion program to Kraken 1, KrakenUniq, or Kraken 2 While Kraken classifies reads to multiple levels in the taxonomic tree, Bracken allows estimation of abundance at a single level using those classifications (e.g.&nbsp;Bracken can estimate abundance of species within a sample)</p>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Help
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do this to get the help information for fastq-scan <!--FIXME: look for the correct help option for Bracken--></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bracken</span> <span class="at">-h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Usage: bracken -d MY_DB -i INPUT -o OUTPUT -w OUTREPORT -r READ_LEN -l LEVEL -t THRESHOLD
  MY_DB          location of Kraken database
  INPUT          Kraken REPORT file to use for abundance estimation
  OUTPUT         file name for Bracken default output
  OUTREPORT      New Kraken REPORT output file with Bracken read estimates
  READ_LEN       read length to get all classifications for (default: 100)
  LEVEL          level to estimate abundance at [options: D,P,C,O,F,G,S,S1,etc] (default: S)
  THRESHOLD      number of reads required PRIOR to abundance estimation to perform reestimation (default: 0)</code></pre>
</div>
</div>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Usage
</div>
</div>
<div class="callout-body-container callout-body">
<p>The general synthax is:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bracken</span> <span class="at">-d</span> <span class="va">${KRAKEN_DB}</span> <span class="at">-t</span> <span class="va">${THREADS}</span> <span class="at">-k</span> <span class="va">${KMER_LEN}</span> <span class="at">-l</span> <span class="va">${READ_LEN}</span> <span class="at">-i</span> {INPUT} <span class="at">-o</span> {OUTPUT}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong><em>NB.</em></strong> <code>Bracken</code> relies on the Kraken 2 database, so we will specify the same directory as before and also use the output report of Kraken 2 as our input.</p>
</div>
</div>
<p>You can now go ahead and perform <code>Bracken</code> with the below command.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Run Bracken with the following command:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bracken</span> <span class="at">-l</span> S <span class="at">-t</span> 10 <span class="at">-d</span> ../database/minikraken2_v1_8GB <span class="at">-i</span> G26832.kraken2.report.txt <span class="at">-o</span> G26832_bracken_S.tsv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> &gt;&gt; Checking for Valid Options...
 &gt;&gt; Running Bracken 
      &gt;&gt; python src/est_abundance.py -i G26832.kraken2.report.txt -o G26832_bracken_S.tsv -k ../../Analysis/database/minikraken2_v1_8GB/database100mers.kmer_distrib -l S -t 10
PROGRAM START TIME: 11-09-2022 18:28:06
&gt;&gt; Checking report file: G26832.kraken2.report.txt
BRACKEN SUMMARY (Kraken report: G26832.kraken2.report.txt)
    &gt;&gt;&gt; Threshold: 10 
    &gt;&gt;&gt; Number of species in sample: 11780 
          &gt;&gt; Number of species with reads &gt; threshold: 17 
          &gt;&gt; Number of species with reads &lt; threshold: 11763 
    &gt;&gt;&gt; Total reads in sample: 2042550
          &gt;&gt; Total reads kept at species level (reads &gt; threshold): 75467
          &gt;&gt; Total reads discarded (species reads &lt; threshold): 60
          &gt;&gt; Reads distributed: 1962804
          &gt;&gt; Reads not distributed (eg. no species above threshold): 4
          &gt;&gt; Unclassified reads: 4215
BRACKEN OUTPUT PRODUCED: G26832_bracken_S.tsv
PROGRAM END TIME: 11-09-2022 18:28:06
  Bracken complete.</code></pre>
</div>
</div>
<p>You should now see two new files generated in your current directory. You can take a look at them as they are small files. You can already guess what specie we are working with from the <code>G26832_bracken_S.tsv</code> file.</p>
</section>
<section id="producing-a-more-friendly-species-composition-file" class="level3">
<h3 class="anchored" data-anchor-id="producing-a-more-friendly-species-composition-file">Producing a more friendly species composition file</h3>
<p>Imagine you have over 100 samples and have produced Bracken output files for each file using a simple bash script. Ho do you check each individual file to see what species abundance there is? This will be tedious right? How can we make things easier for us? For instance have them all in one <code>.tsv</code> file to examine at a go. Your guess is as good as mine. …Let’s write a script for that.</p>
<p>To do this, we can simply parse all the Kraken 2 and Bracken results into a more friendly <code>.tsv</code> file that summarises all the output into one file. We will achieve this with a simple python script.</p>
<section id="parse-kraken-2-and-bracken-results-files-into-tsv-format" class="level4">
<h4 class="anchored" data-anchor-id="parse-kraken-2-and-bracken-results-files-into-tsv-format">Parse Kraken 2 and Bracken results files into tsv format</h4>
<p>We will run a simple python script to achieve this purpose. In your working directory, you will find a file named <code>kraken_parser.py</code>. This is a simple python script that will do the job for us.</p>
<p>We can go ahead and execute that python script by running the command below:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> kraken_parser.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You should now see another file generated in your directory called <code>Bracken_species_composition.tsv</code>.</p>
<p>Now let’s go ahead and have a look at the <code>tsv</code> file with the command below. Remember, we have run analysis on only one sample and so will expect only one line of results.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="sourceCode" id="cb42"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> Bracken_species_composition.tsv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>name    Mycobacterium tuberculosis  other
G26832_bracken  99.58682581959188   0.41317418040812015</code></pre>
</div>
</div>
</div>
<p>Alternatively, you can open the <code>tsv</code> file with any appropriate GUI software (excel or libreoffice)</p>
<p>Now, what if we want to also see all the QC statistics in one go provided we performed the analysis for multiple samples (or in our case even for just one sample).</p>
<p>Thankfully, bioinformaticians are not sleeping, there is one final tool (<em>MultiQC</em>) we will discuss here which puts all that analysis we have performed into a single report that is viewable on a web browser, yes an <code>.html</code> file.</p>
</section>
</section>
<section id="multiqc" class="level3">
<h3 class="anchored" data-anchor-id="multiqc"><a href="https://github.com/ewels/MultiQC">MultiQC</a></h3>
<p>click <a href="https://pubmed.ncbi.nlm.nih.gov/27312411/">here</a> to view the publication on <a href="https://pubmed.ncbi.nlm.nih.gov/27312411/">MultiQC</a> or check out their <a href="https://multiqc.info/">website</a></p>
<p>MultiQC is a tool to create a single report with interactive plots for multiple bioinformatics analyses across many samples.</p>
<p>Reports are generated by scanning given directories for recognised log files. These are parsed and a single HTML report is generated summarising the statistics for all logs found. MultiQC reports can describe multiple analysis steps and large numbers of samples within a single plot, and multiple analysis tools making it ideal for routine fast quality control.</p>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Help
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do this to get the help information for fastq-scan</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="ex">multiqc</span> <span class="at">-h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="../fig/multiqc_help.png" class="img-fluid"></p>
</div>
</div>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Usage
</div>
</div>
<div class="callout-body-container callout-body">
<p>Once installed, you can use MultiQC by navigating to your analysis directory (or a parent directory) and running the tool.</p>
<p>The general synthax is:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="ex">multiqc</span> .</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Yes, that’s it! MultiQC will scan the specified directory (<code>.</code> is the current dir) and produce a report detailing whatever it finds.</p>
</div>
</div>
<p>You can now go ahead and perform the <code>MultiQC</code> with the below command. We will only add the <code>-f</code> flag which overwrites any existing MultiQC reports.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Perform the analysis with this command:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="ex">multiqc</span> <span class="at">-f</span> .</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="../fig/multiqc_run.png" class="img-fluid"></p>
</div>
</div>
<p>The report is created in <code>multiqc_report.html</code> by default. Tab-delimited data files are also created in a directory called <code>multiqc_data/</code>, containing extra information. These can be easily inspected using Excel.</p>
<p>You should now see two new files generated in your current directory.</p>
<p>Let’s have a quick look the report by simply opening it in a web browser.</p>
<p><img src="../fig/multiqc_web.png" class="img-fluid"></p>
<p>We should now know what each plot represent. If you don’t at this point, then you may want to start from the beginning of this document.</p>
</section>
</section>
<section id="qc-bash-script-putting-it-all-together" class="level2">
<h2 class="anchored" data-anchor-id="qc-bash-script-putting-it-all-together">4.1.5 QC bash script: Putting it all together</h2>
<p>Now let’s try this out! We will generate QC stats for three pairs of reads from Illumina paired-end sequencing. We will perform all the analysis above in one run while generating all the various files at each stage within the pipeline in tandem.</p>
<section id="running-multiple-samples-with-a-simple-bash-script" class="level3">
<h3 class="anchored" data-anchor-id="running-multiple-samples-with-a-simple-bash-script">Running multiple samples with a simple bash script</h3>
<p>All the <code>fastq</code> files needed for this analysis are located in the current working QC directory. You can have a look by simply running the below command to check out all the forward reads present in the current directory.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="sourceCode" id="cb47"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="pp">*</span>R1.fastq.gz </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>G26832_R1.fastq.gz  G33041_R1.fastq.gz ERX1027829_ERR948844_R1.fastq.gz</code></pre>
</div>
</div>
</div>
<p>Let’s have a look at the QC bash script we are going to run:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> qcloop.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The script contains several commands, some are combined together using pipes. (UNIX pipes is a very powerful and elegant concept which allows us to feed the output of one command into the next command and avoid writing intermediate files. If you are not comfortable with UNIX or how scripts look like and how they work, consider having a go at the <a href="../02-unix_intro/">UNIX</a> tutorial or more specifically <a href="../../materials/02-unix_intro/2.9-bonus_shell_scripts.html">bonus shell script</a>.</p>
<p>Now run the script to create the QC stats (this may take a while):</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div class="sourceCode" id="cb50"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> qcloop.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>###########################################
#### loop bash script for running QC ######
###########################################
#               #
#  ___   ____   #
# / _ \ / ___|  #
# | | | | |     #
# | |_| | |___  #
# \__\_\ \____| #
#               #
#               #
############################################
fastq-scan_parser.py exists and will run in a second.
 &lt;&lt;&lt;&lt;&lt;&lt;&lt;running fastq-scan_parser&gt;&gt;&gt;&gt;&gt;&gt;&gt;
Traceback (most recent call last):
...</code></pre>
</div>
</div>
</div>
<p>The script will produce all the intermediate and final files we have encountered in this session.</p>
<p>Perform a simple <code>ls</code> command with the arguments <code>-lhrt</code> and view the most recent files created.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-lhrt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Which files do you consider most useful?</p>
<p>Now, let’s have a look at the two most important files here — The <code>multiqc_report.html</code> and the <code>Bracken_species_composition.tsv</code>.</p>
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong><em>Exercise 4.1.5.1:</em></strong> MultiQC and Species Composition Report Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Have a quick look at both MultiQC report and Bracken species composition files and attempt these questions</p>
<ol type="1">
<li>How many genomes were analysed?</li>
<li>What is the average read length of each read?</li>
<li>What is the average GC content of each genome?</li>
<li>Will you pass all the reads as being good reads? <em>Given a phred quality score threshold of 30.</em></li>
<li>Identify the reads that failed QC and report what could be wrong with the sequences.</li>
<li>What are the most abundant species identified in each of the genomes?</li>
<li>Are there any suspected contaminants in any of the genomes?</li>
</ol>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong><em>Solution:</em></strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Sorry, no solution.</p>
<p>If you are having any challenges just hold on, we will solve this together in class.</p>
</div>
</div>
</div>
</div>
</div>
<p>If you have successfully gone through the exercise above, congratulations!!! You are a bioinformatics QC expert now.</p>
<p>Now, let’s copy the <code>trimmed</code> genome that we are most confident in to another directory called <code>short_read_mapping</code>. We will carry out our mapping and pseudogenome assembly of short reads from this genome in our next lesson.</p>
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong><em>Exercise 4.1.5.2:</em></strong> Copy to and view content from the <em>short_read_mapping</em> directory
</div>
</div>
<div class="callout-body-container callout-body">
<p>The next lesson’s directory is called <strong>short_read_mapping</strong>. Go ahead and copy the two reads, <code>G26832_R1.trim.fastq.gz</code> and <code>G26832_R2.trim.fastq.gz</code> into the <strong>short_read_mapping</strong> directory. This directory is one level above your current directory. After copying the files to the <strong>short_read_mapping</strong> directory, verify if they were successfully copied.</p>
<p><strong>NB.</strong> Don’t leave your current working <strong>QC</strong> directory</p>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong><em>Solution:</em></strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Do this to copy the files to the <strong>short_read_mapping</strong> directory</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> G26832_R<span class="pp">?</span>.trim.fastq.gz ../short_read_mapping</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Do this to view the files from the <strong>short_read_mapping</strong> directory</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> ../short_read_mapping/G26832<span class="pp">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="disk-usage-ii-cleaning-up-after-analysis" class="level3">
<h3 class="anchored" data-anchor-id="disk-usage-ii-cleaning-up-after-analysis">Disk Usage II — Cleaning up after analysis</h3>
<p>Now that we are done investigating our genomic sequences, let’s pause again and check the space of our current working directory.</p>
<p>You can do this with the <strong>d</strong>isk <strong>u</strong>sage <code>du</code> command</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">du</span> <span class="at">-h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>How much disk space have you used since the start of the analysis? I’m sure it’s more than 4G. That’s fine. Let’s do some cleaning up. We will remove <code>rm</code> all files that we may not need for further analysis. Most of these files are intermediate files and can always be reproduced if we need to.</p>
<p>You will find this cleaning process very useful in the next chapter where we will generate tonnes and tonnes of data.</p>
<section id="remove-all-trimmed-fastq-files-if-not-needed" class="level4">
<h4 class="anchored" data-anchor-id="remove-all-trimmed-fastq-files-if-not-needed">remove all <code>trimmed</code> fastq files if not needed</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="pp">*</span>trim<span class="pp">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="remove-all-classified-and-unclassified-fastq-files-if-not-needed" class="level4">
<h4 class="anchored" data-anchor-id="remove-all-classified-and-unclassified-fastq-files-if-not-needed">remove all <code>classified</code> and <code>unclassified</code> fastq files if not needed</h4>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="pp">*</span>classified<span class="pp">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="remove-all-kraken-2-output-if-not-needed" class="level4">
<h4 class="anchored" data-anchor-id="remove-all-kraken-2-output-if-not-needed">remove all <code>Kraken 2</code> output if not needed</h4>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="pp">*</span>kraken2.out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong><em>Exercise 4.1.5.3:</em></strong> Advance Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have gone through this material in good time and still want to try your hands on some more advanced stuff, you are free to do this exercise.</p>
<p>Try modifying the <code>qcloop</code> script to be able to carry out analysis on a specific pair of fastq reads given that you have more than one pair of fastq in your working directory (<em>assuming you want to perform QC again on only the one that passed our quality checks</em>).</p>
<p>You can call the new script `qcloop_modified``</p>
<p>You should be able to call out the script to carry out the analysis on the specified fastq files with the below command</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> qcloop_modified G26832_R1.fastq.gz G26832_R2.fastq.gz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong><em>Solution:</em></strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<!--FIXME: Provide a solution to the advance exercise here-->
</div>
</div>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="deactivate-qc-environment" class="level2">
<h2 class="anchored" data-anchor-id="deactivate-qc-environment">4.1.6 deactivate <code>qc</code> environment</h2>
<p>Now that we are done with all our analysis, let’s deactivate the <code>qc</code> environment:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mamba</span> deactivate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="credit" class="level2">
<h2 class="anchored" data-anchor-id="credit">4.1.7 Credit</h2>
<p>Information on this page has been adapted and modified from the following source(s):</p>
<ul>
<li><p>https://github.com/sanger-pathogens/QC-training</p></li>
<li><p>https://github.com/rpetit3/fastq-scan</p></li>
<li><p>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</p></li>
<li><p>https://github.com/OpenGene/fastp</p></li>
<li><p>https://github.com/DerrickWood/kraken2</p></li>
<li><p>https://github.com/jenniferlu717/Bracken</p></li>
<li><p>https://github.com/ewels/MultiQC</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../materials/03-file_formats/3.1-file_formats.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">3.1 Common File Formats</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../materials/05-short_read_mapping/5.1-short_read_mapping.html" class="pagination-link">
        <span class="nav-page-text">5.1 Short Read Mapping</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Licensed <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> <img src="https://creativecommons.org/images/deed/cc_icon_black_x2.png" class="img-fluid" width="25"> Dr Prince Asare and Dr Andries van Tonder</div>
  </div>
</footer>



</body></html>